### 项目实现过程

1.  根据项目的功能需求确定大体的代码框架。查阅模块资料，编写测试代码，测试每一个模块是否正常。
2.  实现矩阵按键键值的获取，使用事件标志组和外部中断实现。
3.  实现按键设置密码以及密码解锁的功能。密码可设置为两个（一个是管理员，一个是用户，都是六位密码），如果匹配两个中的一个成功，即可开锁，也可通过按键修改密码。
4.  实现OLED的手动字库和数据的锁存，以及部分像素点数据清除的功能。
5.  实现RFID的录入、删除、解锁功能：
    -   录入：已经录入过的卡会提示已经存在。如果是新卡，则会将其序列号存在flash中。
    -   删除：删除一张卡是通过刷卡删除的，要删除的卡不存在则提示不存在，如果存在，则将序列号从flash中删除；删除多张卡则全部删除，即清空flash。
    -   解锁：RFID任务会判断读入的卡的ID是否存在flash里面，存在则开锁成功。RFID操作任务和RFID解锁任务是互斥执行的。
6.  实现指纹的录入、删除、查询和解锁功能：
    -   录入：指纹录入成功，将用户输入的ID信息保存到flash中。
    -   删除：可以删除指定ID的指纹或所有指纹，也可以通过刷指纹来删除，如果采集的指纹与指纹库匹配则删除。这些操作都会更新flash里面的内容。
    -   查询：显示已经录入的指纹的ID号（最多显示４条记录以示意）。
    -   解锁：如果采集的指纹与指纹库匹配则开锁。指纹操作任务和指纹解锁任务是互斥执行的。
7.  自定义数据协议，实现通过蓝牙修改管理员和用户名密码，以及解锁功能，其中密码设置限制只能是数字。
8.  以上操作过程的提示信息都会显示在OLED上。如果解锁成功，则会显示解锁图片，并在OLED上显示是什么方式解锁成功，同时会发送蜂鸣器任务的内嵌信号量，蜂鸣器响，表示解锁成功。RFID、密码和指纹的管理操作，要先进行管理员密码的验证，成功后才能进行后续操作。
9.  最后，进行总体测试，并改善相关代码。

### 接线说明

4*4矩阵按键：PB7 -- 1，PA4 -- 2，PD6 -- 3，PD7 -- 4，PC6 -- 5，PC7 -- 6，PC8 -- 7，PC9 -- 8

OLED：PE8 -- SCL，PE10 -- SDA，PD1 -- VCC，PD15 -- GND

RFID：PD14 -- CS（SDA），PD0 -- SCK，PE7 -- MOSI，PE9 -- MISO，PE13 -- GND，PE15 -- RST，PD9 -- VCC

蓝牙：使用了串口二。VCC--5V，TXD--RXD2（PA3），RXD--TXD2（PA2）

指纹：使用了串口三。Vi--3.3V，TX--RX3（PB11），RX--TX3（PB10），WAK（touch）--PA6，touchVin--PB8（3.3V）

### 数据协议

蓝牙：包头+包标识+命令+数据+校验+结束标志（校验是从包标识至校验和之间所有字节之和）

手机发送数据格式如下：

-   修改用户密码：BG1CHGUSERXXXXXXE#	长度：18
-   修改管理员密码：BG1CHGADMINXXXXXXF#	长度：19
-   解锁：BG1OPENXXXXXXB#	长度：15

其中，以修改用户密码为例：BG（表示开始），1（表示这个数据包是命令），XXXXXX（表示6位密码），E（表示校验），#（结束标志）

具体的命令有：CHGUSER（修改用户密码），CHGADMIN（修改管理员密码），OPEN（开锁）。